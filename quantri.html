<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QU·∫¢N TR·ªä H·ªÜ TH·ªêNG C·ª®U H·ªò KH·∫®N C·∫§P</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script> <!-- Th∆∞ vi·ªán xu·∫•t Excel -->
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: #e2e8f0; margin: 0; }
    .card { background: rgba(30, 41, 59, 0.85); backdrop-filter: blur(12px); border: 1px solid rgba(148, 163, 184, 0.2); }
    #map { height: 520px; border-radius: 1rem; border: 3px solid #2563eb; box-shadow: 0 10px 30px rgba(37, 99, 235, 0.4); }
    .marker-pin { width: 36px; height: 36px; border-radius: 50% 50% 50% 0; transform: rotate(-45deg); background: #ef4444; box-shadow: 0 0 20px #ef4444aa; position: relative; }
    .marker-pin::after { content: ''; position: absolute; width: 16px; height: 16px; background: white; border-radius: 50%; top: 10px; left: 10px; }
    .marker-rescue { background: #3b82f6 !important; box-shadow: 0 0 20px #3b82f6aa !important; }
    .marker-warning { background: #f59e0b !important; box-shadow: 0 0 20px #f59e0baa !important; }
    .pulse { animation: pulse 2s infinite; }
    @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.8); } 70% { box-shadow: 0 0 0 25px rgba(239, 68, 68, 0); } 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } }
    .btn-gov { background: #dc2626; font-weight: bold; }
    .btn-gov:hover { background: #b91c1c; }
    .text-shadow { text-shadow: 0 2px 4px rgba(0,0,0,0.6); }
    .glow { box-shadow: 0 0 20px rgba(59, 130, 246, 0.5); }
    
    /* Scrollbar ƒë·∫πp */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #1e293b; }
    ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #64748b; }
  </style>
</head>
<body class="min-h-screen">

  <!-- HEADER QU·ªêC GIA -->
  <div class="bg-red-600 text-white py-4 shadow-2xl relative overflow-hidden">
    <div class="absolute inset-0 opacity-10">
      <svg viewBox="0 0 100 60" class="w-full h-full"><rect width="100" height="60" fill="#da291c"/><path d="M50 15 L53.8 25.2 L64.5 25.2 L55.9 31.8 L58.6 42 L50 36 L41.4 42 L44.1 31.8 L35.5 25.2 L46.2 25.2 Z" fill="#ffff00"/></svg>
    </div>
    <div class="max-w-7xl mx-auto px-6 flex items-center justify-between relative z-10">
      <div class="flex items-center gap-6">
        <div class="w-28 h-20 rounded-lg overflow-hidden shadow-2xl border-4 border-yellow-400">
          <svg viewBox="0 0 90 60" class="w-full h-full"><rect width="90" height="60" fill="#da291c"/><path d="M45 15 L48.8 25.2 L59.5 25.2 L50.9 31.8 L53.6 42 L45 36 L36.4 42 L39.1 31.8 L30.5 25.2 L41.2 25.2 Z" fill="#ffff00"/></svg>
        </div>
        <div>
          <h1 class="text-2xl md:text-3xl font-bold leading-tight">C·ªòNG H√íA X√É H·ªòI CH·ª¶ NGHƒ®A VI·ªÜT NAM</h1>
          <p class="text-xl md:text-2xl font-bold text-yellow-300">ƒê·ªôc l·∫≠p ‚Äì T·ª± do ‚Äì H·∫°nh ph√∫c</p>
        </div>
      </div>
      <div class="text-right hidden md:block">
        <p class="text-2xl md:text-3xl font-bold">H·ªÜ TH·ªêNG C·ª®U H·ªò KH·∫®N C·∫§P</p>
        <p class="text-lg md:text-xl font-semibold opacity-95">T·ªàNH KH√ÅNH H√íA & NINH THU·∫¨N</p>
      </div>
    </div>
    <div class="absolute bottom-0 left-0 right-0 h-2 bg-gradient-to-r from-yellow-400 via-yellow-500 to-yellow-400"></div>
  </div>

  <!-- M√ÄN H√åNH ƒêƒÇNG NH·∫¨P -->
  <div id="loginScreen" class="flex items-center justify-center min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-black -mt-32">
    <div class="card p-12 rounded-2xl shadow-2xl w-full max-w-lg border border-red-700 glow">
      <div class="text-center mb-8">
        <i class="fas fa-shield-alt text-6xl text-red-500 mb-4"></i>
        <h1 class="text-4xl font-bold text-red-400 text-shadow">QU·∫¢N TR·ªä H·ªÜ TH·ªêNG</h1>
        <p class="text-yellow-300 mt-2 text-lg">C·ª®U H·ªò KH·∫®N C·∫§P T·ªàNH</p>
      </div>
      <input type="text" id="username" placeholder="T√†i kho·∫£n qu·∫£n tr·ªã" class="w-full p-4 mb-4 rounded-lg bg-slate-800 text-white text-lg border border-gray-600 focus:border-red-500 focus:outline-none transition" />
      <input type="password" id="password" placeholder="M·∫≠t kh·∫©u" class="w-full p-4 mb-6 rounded-lg bg-slate-800 text-white text-lg border border-gray-600 focus:border-red-500 focus:outline-none transition" />
      <button onclick="login()" class="w-full btn-gov text-white py-4 rounded-lg text-xl font-bold transition shadow-lg hover:shadow-red-600/50">ƒêƒÇNG NH·∫¨P H·ªÜ TH·ªêNG</button>
    </div>
  </div>

  <!-- GIAO DI·ªÜN QU·∫¢N TR·ªä -->
  <div id="adminPanel" class="hidden pb-10">

    <!-- THANH C√îNG C·ª§ -->
    <div class="bg-gradient-to-r from-blue-900 to-blue-800 p-5 shadow-2xl flex flex-col md:flex-row justify-between items-center gap-4 sticky top-0 z-50">
      <div>
        <h2 class="text-2xl font-bold text-yellow-300">B·∫¢NG ƒêI·ªÄU KHI·ªÇN QU·∫¢N TR·ªä</h2>
        <p class="text-sm opacity-90">C·∫≠p nh·∫≠t realtime ‚Ä¢ Phi√™n b·∫£n 2025</p>
      </div>
      <button onclick="logout()" class="bg-red-700 hover:bg-red-800 px-8 py-3 rounded-lg font-bold transition">ƒêƒÉng xu·∫•t</button>
    </div>

    <div class="max-w-7xl mx-auto p-6 space-y-8">

      <!-- --- 1. THANH T√ÅC V·ª§ KH·∫®N C·∫§P (NEW FEATURES) --- -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 animate-slide-up">
        <button onclick="templateEvacuate()" class="bg-red-600 hover:bg-red-700 text-white p-4 rounded-xl font-bold shadow-lg flex flex-col items-center gap-2 border border-red-400">
            <i class="fas fa-bullhorn text-3xl"></i>
            <span>M·∫™U L·ªÜNH DI T·∫¢N</span>
        </button>
        <button onclick="templateFlood()" class="bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-xl font-bold shadow-lg flex flex-col items-center gap-2 border border-blue-400">
            <i class="fas fa-water text-3xl"></i>
            <span>M·∫™U X·∫¢ L≈®</span>
        </button>
        <button onclick="exportToExcel()" class="bg-green-600 hover:bg-green-700 text-white p-4 rounded-xl font-bold shadow-lg flex flex-col items-center gap-2 border border-green-400">
            <i class="fas fa-file-excel text-3xl"></i>
            <span>XU·∫§T D·ªÆ LI·ªÜU</span>
        </button>
        <button onclick="clearAllData()" class="bg-gray-700 hover:bg-red-900 text-white p-4 rounded-xl font-bold shadow-lg flex flex-col items-center gap-2 border border-gray-500">
            <i class="fas fa-trash-alt text-3xl text-red-500"></i>
            <span>X√ìA TO√ÄN B·ªò</span>
        </button>
      </div>

      <!-- B·∫¢N ƒê·ªí REALTIME -->
      <div class="card rounded-2xl p-6 shadow-2xl border border-blue-600 glow">
        <h2 class="text-2xl font-bold mb-4 text-cyan-300 flex items-center gap-3">B·∫¢N ƒê·ªí C·ª®U H·ªò REALTIME</h2>
        <div id="map"></div>
        <div class="mt-4 grid grid-cols-3 gap-4 text-center">
          <div class="bg-red-900/70 p-4 rounded-lg border border-red-600">
            <p class="text-4xl font-bold text-red-400" id="victimCount">0</p>
            <p class="text-sm">C·∫ßn c·ª©u h·ªô</p>
          </div>
          <div class="bg-blue-900/70 p-4 rounded-lg border border-blue-600">
            <p class="text-4xl font-bold text-blue-400" id="rescueCount">0</p>
            <p class="text-sm">ƒê·ªôi c·ª©u h·ªô</p>
          </div>
          <div class="bg-gray-800 p-4 rounded-lg border border-gray-600">
            <p class="text-4xl font-bold text-yellow-400" id="totalReports">0</p>
            <p class="text-sm">T·ªïng b√°o c√°o</p>
          </div>
        </div>
      </div>

      <!-- G·ª¨I C·∫¢NH B√ÅO & ƒêƒÇNG K√ù ƒê·ªòI -->
      <div class="grid md:grid-cols-2 gap-8">
        <!-- G·ª¨I C·∫¢NH B√ÅO -->
        <div class="card rounded-2xl p-6 border-2 border-orange-600 glow">
          <h3 class="text-2xl font-bold text-orange-300 mb-5 flex items-center gap-3">G·ª¨I C·∫¢NH B√ÅO KH·∫®N C·∫§P</h3>
          <!-- Toolbar -->
          <div class="bg-slate-900/90 rounded-xl p-4 mb-4 border border-orange-500 shadow-lg">
            <div class="flex flex-wrap gap-2 items-center text-sm">
              <button type="button" onclick="document.execCommand('bold')" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600"><b>B</b></button>
              <button type="button" onclick="document.execCommand('italic')" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600"><i>I</i></button>
              <button type="button" onclick="document.execCommand('underline')" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600"><u>U</u></button>
              <select onchange="document.execCommand('foreColor', false, this.value)" class="bg-gray-700 text-white rounded p-1">
                <option value="#ffffff">Tr·∫Øng</option><option value="#ff0000">ƒê·ªè</option><option value="#ffff00">V√†ng</option>
              </select>
              <select onchange="document.execCommand('backColor', false, this.value)" class="bg-gray-700 text-white rounded p-1">
                <option value="transparent">Ko n·ªÅn</option><option value="#dc2626">N·ªÅn ƒê·ªè</option><option value="#f59e0b">N·ªÅn V√†ng</option>
              </select>
              <select onchange="document.execCommand('fontSize', false, this.value)" class="bg-gray-700 text-white rounded p-1">
                <option value="3">Nh·ªè</option><option value="5">V·ª´a</option><option value="7" selected>To</option>
              </select>
            </div>
          </div>
          <div id="warnMsg" contenteditable="true" class="w-full min-h-56 p-6 rounded-xl bg-slate-900/95 text-white border-2 border-orange-500 focus:border-orange-400 outline-none text-lg leading-relaxed shadow-inner overflow-y-auto" style="max-height: 400px;">
          </div>
          <button onclick="addWarning()" class="mt-5 w-full bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 py-4 rounded-xl font-bold text-xl text-white transition shadow-xl">G·ª¨I C·∫¢NH B√ÅO TO√ÄN T·ªàNH</button>
        </div>

        <!-- ƒêƒÇNG K√ù ƒê·ªòI C·ª®U H·ªò -->
        <div class="card rounded-2xl p-6 border-2 border-blue-600 glow">
          <h3 class="text-xl font-bold text-blue-300 mb-4">ƒêƒÇNG K√ù ƒê·ªòI C·ª®U H·ªò</h3>
          <input type="text" id="rescueName" placeholder="T√™n ƒë·ªôi / ƒê∆°n v·ªã" class="w-full p-4 mb-3 rounded bg-slate-800 text-white border border-gray-600 focus:border-blue-500 outline-none" />
          <input type="tel" id="rescuePhone" placeholder="S·ªë ƒëi·ªán tho·∫°i li√™n l·∫°c" class="w-full p-4 mb-4 rounded bg-slate-800 text-white border border-gray-600 focus:border-blue-500 outline-none" />
          <button onclick="addRescueTeam()" class="w-full bg-blue-600 hover:bg-blue-700 py-4 rounded font-bold text-lg transition">ƒêƒÇNG K√ù S·∫¥N S√ÄNG</button>
        </div>
      </div>

      <!-- DANH S√ÅCH CHI TI·∫æT + T√åM KI·∫æM -->
      <div class="card rounded-2xl p-6 shadow-2xl border border-gray-600">
        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
            <h2 class="text-2xl font-bold text-yellow-400 flex items-center gap-3">DANH S√ÅCH B√ÅO C√ÅO</h2>
            <!-- --- 2. √î T√åM KI·∫æM (SEARCH) --- -->
            <div class="relative w-full md:w-96">
                <input type="text" id="searchInput" onkeyup="filterReports()" placeholder="T√¨m theo SƒêT ho·∫∑c n·ªôi dung..." class="w-full p-3 pl-10 rounded-full bg-slate-700 text-white border border-gray-500 focus:border-blue-400 outline-none shadow-inner" />
                <i class="fas fa-search absolute left-4 top-3.5 text-gray-400"></i>
            </div>
        </div>
        <div id="allReports" class="space-y-4 max-h-[800px] overflow-y-auto pr-2"></div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const ADMIN_ACCOUNTS = [{username:"admin",password:"Lenhan@123"},{username:"canbo",password:"1"},{username:"khanhhoa",password:"1"}];
    let map, markers = L.layerGroup();
    let currentReports = [];

    // --- C√ÅC CH·ª®C NƒÇNG KH·∫®N C·∫§P M·ªöI ---

    // 1. M·∫´u L·ªánh Di T·∫£n
    function templateEvacuate() {
        const t = document.getElementById('warnMsg');
        t.innerHTML = `
            <p style="text-align: center;"><span style="color: #ff0000; font-size: xxx-large;"><strong>L·ªÜNH DI T·∫¢N KH·∫®N C·∫§P</strong></span></p>
            <p style="text-align: center;"><span style="background-color: #dc2626; color: #ffff00; padding: 5px 10px; border-radius: 5px; font-size: x-large;"><strong>KHU V·ª∞C NGUY HI·ªÇM C·∫§P ƒê·ªò 5</strong></span></p>
            <p><strong>‚ö†Ô∏è Y√äU C·∫¶U:</strong> To√†n b·ªô ng∆∞·ªùi d√¢n t·∫°i v√πng tr≈©ng th·∫•p di chuy·ªÉn ngay l√™n v√πng cao/nh√† ki√™n c·ªë.</p>
            <p><strong>‚è≥ TH·ªúI GIAN:</strong> Ph·∫£i ho√†n th√†nh tr∆∞·ªõc 18:00 h√¥m nay.</p>
            <p><strong>üìû H·ªñ TR·ª¢:</strong> G·ªçi ngay 114 n·∫øu kh√¥ng th·ªÉ di chuy·ªÉn.</p>
        `;
    }

    // 2. M·∫´u X·∫£ L≈©
    function templateFlood() {
        const t = document.getElementById('warnMsg');
        t.innerHTML = `
            <p><span style="color: #0000ff; font-size: xx-large;"><strong>‚ö†Ô∏è TH√îNG B√ÅO X·∫¢ L≈® H·ªí CH·ª®A</strong></span></p>
            <p>L√∫c <strong>... gi·ªù ... ph√∫t</strong>, H·ªì ch·ª©a n∆∞·ªõc ... s·∫Ω ti·∫øn h√†nh x·∫£ l≈©.</p>
            <p>L∆∞u l∆∞·ª£ng x·∫£ d·ª± ki·∫øn: <strong>... m3/s</strong>.</p>
            <p><span style="color: #ff0000;">B√† con ven s√¥ng ch√∫ √Ω neo ƒë·∫≠u t√†u thuy·ªÅn, kh√¥ng chƒÉn th·∫£ gia s√∫c ven b·ªù.</span></p>
        `;
    }

    // 3. Xu·∫•t Excel
    function exportToExcel() {
        if(currentReports.length === 0) return alert('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t!');
        // Chu·∫©n h√≥a d·ªØ li·ªáu
        const data = currentReports.map(r => ({
            "Th·ªùi gian": r.timestamp,
            "Lo·∫°i": r.type === 'victim' ? 'C·∫•p c·ª©u' : (r.type === 'rescue' ? 'ƒê·ªôi c·ª©u h·ªô' : 'C·∫£nh b√°o'),
            "N·ªôi dung": r.message.replace(/<[^>]*>?/gm, ''), // X√≥a HTML tag
            "SƒêT": r.phone || '',
            "S·ªë ng∆∞·ªùi": r.people || '',
            "Vƒ© ƒë·ªô": r.lat,
            "Kinh ƒë·ªô": r.lng,
            "IP G·ª≠i": r.ip
        }));

        const ws = XLSX.utils.json_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "BaoCao");
        const filename = `DuLieu_CuuHo_${new Date().toISOString().slice(0,10)}.xlsx`;
        XLSX.writeFile(wb, filename);
    }

    // 4. X√≥a T·∫•t C·∫£
    async function clearAllData() {
        const code = prompt("NH·∫¨P M√É X√ÅC NH·∫¨N ƒê·ªÇ X√ìA TO√ÄN B·ªò D·ªÆ LI·ªÜU:\n(Nh·∫≠p: 'reset')");
        if(code !== 'reset') return alert('M√£ sai! H·ªßy thao t√°c.');
        
        // Loop x√≥a t·ª´ng c√°i (V√¨ API backend ƒë∆°n gi·∫£n ch∆∞a c√≥ endpoint delete_all)
        // C√°ch n√†y h∆°i th·ªß c√¥ng nh∆∞ng an to√†n v·ªõi code backend hi·ªán t·∫°i
        if(confirm('C·∫¢NH B√ÅO CU·ªêI: To√†n b·ªô d·ªØ li·ªáu s·∫Ω b·ªã x√≥a vƒ©nh vi·ªÖn?')) {
            const btn = document.querySelector('button[onclick="clearAllData()"]');
            btn.innerHTML = '‚è≥ ƒêANG X√ìA...';
            
            for(let r of currentReports) {
                await fetch(`/api/reports/${r.id}`, { method: 'DELETE' });
            }
            alert('ƒê√£ x√≥a s·∫°ch h·ªá th·ªëng!');
            loadAllReports();
            btn.innerHTML = '<i class="fas fa-trash-alt text-3xl text-red-500"></i><span>X√ìA TO√ÄN B·ªò</span>';
        }
    }

    // 5. T√¨m ki·∫øm (Client-side)
    function filterReports() {
        const term = document.getElementById('searchInput').value.toLowerCase();
        const items = document.querySelectorAll('.report-item');
        items.forEach(item => {
            const text = item.innerText.toLowerCase();
            item.style.display = text.includes(term) ? 'block' : 'none';
        });
    }

    // --- C√ÅC H√ÄM C≈® ---
    function login() {
      const user = document.getElementById('username').value.trim();
      const pass = document.getElementById('password').value;
      if (ADMIN_ACCOUNTS.some(a => a.username === user && a.password === pass)) {
        document.getElementById('loginScreen').classList.add('hidden');
        document.getElementById('adminPanel').classList.remove('hidden');
        initMap();
        loadAllReports();
        setInterval(loadAllReports, 5000);
      } else { alert('Sai m·∫≠t kh·∫©u!'); }
    }
    function logout() { location.reload(); }

    function initMap() {
      map = L.map('map').setView([12.24, 109.19], 10);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
      markers.addTo(map);
    }

    function createMarker(r) {
      const isVictim = !r.type || r.type === 'victim';
      const iconClass = isVictim ? 'marker-pin pulse' : r.type === 'rescue' ? 'marker-pin marker-rescue pulse' : 'marker-pin marker-warning pulse';
      const icon = L.divIcon({className: "custom-div-icon", html: `<div class="${iconClass}"></div>`, iconSize: [36, 36], iconAnchor: [18, 36]});
      const popup = `<div class="bg-gray-900 text-white p-3 rounded"><b>${r.message}</b><br>${r.phone||''}</div>`;
      L.marker([r.lat, r.lng], { icon }).addTo(markers).bindPopup(popup);
    }

    async function loadAllReports() {
      try {
        const res = await fetch('/api/reports?admin=true&t=' + Date.now());
        const reports = await res.json();
        currentReports = reports;
        markers.clearLayers();
        
        let v=0, re=0;
        const html = reports.map(r => {
            if(!r.type || r.type === 'victim') v++;
            if(r.type === 'rescue') re++;
            const isVictim = !r.type || r.type === 'victim';
            const bg = isVictim ? 'border-red-600' : r.type === 'rescue' ? 'border-blue-600' : 'border-orange-600';
            const txt = isVictim ? 'text-red-400' : r.type === 'rescue' ? 'text-blue-400' : 'text-orange-400';
            
            return `
            <div class="report-item bg-slate-800/80 p-5 rounded-xl border-l-8 ${bg} hover:bg-slate-700/80 transition relative">
              <div class="font-bold text-lg ${txt}">${r.message}</div>
              ${r.phone ? `<div class="text-green-400 font-bold mt-1"><i class="fas fa-phone"></i> ${r.phone}</div>` : ''}
              ${r.people ? `<div class="text-yellow-300">Ng∆∞·ªùi: ${r.people}</div>` : ''}
              <div class="text-xs text-gray-500 mt-2">${r.timestamp} ‚Ä¢ IP: ${r.ip||'N/A'}</div>
              <button onclick="deleteReport(${r.id})" class="absolute top-4 right-4 text-red-500 text-2xl font-bold">√ó</button>
            </div>`;
        }).join('');
        
        document.getElementById('victimCount').textContent = v;
        document.getElementById('rescueCount').textContent = re;
        document.getElementById('totalReports').textContent = reports.length;
        document.getElementById('allReports').innerHTML = html;
        reports.forEach(createMarker);
        
        // Gi·ªØ b·ªô l·ªçc t√¨m ki·∫øm n·∫øu ƒëang nh·∫≠p
        filterReports();
      } catch (e) {}
    }

    async function deleteReport(id) {
      if (confirm('X√≥a b√°o c√°o n√†y?')) {
        await fetch(`/api/reports/${id}`, { method: 'DELETE' });
        loadAllReports();
      }
    }

    async function addWarning() {
      const html = document.getElementById('warnMsg').innerHTML;
      await fetch('/api/reports', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ lat: 12.24, lng: 109.19, message: html, type: 'warning' }) });
      alert('ƒê√£ g·ª≠i c·∫£nh b√°o!'); document.getElementById('warnMsg').innerHTML = ''; loadAllReports();
    }
    async function addRescueTeam() {
        const name = document.getElementById('rescueName').value;
        const phone = document.getElementById('rescuePhone').value;
        if(!name || !phone) return alert('Thi·∫øu th√¥ng tin');
        await fetch('/api/reports', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ lat: 12.24, lng: 109.19, message: `ƒê·ªòI C·ª®U H·ªò: ${name}`, phone, type: 'rescue' }) });
        alert('ƒê√£ th√™m ƒë·ªôi!'); loadAllReports();
    }
  </script>
</body>
</html>
